@page "/Resume"
@using LaborExchange.Frontend.Clients;
@using LaborExchange.Frontend.Models.Resume;
@inject ResumeClient Client;

@rendermode InteractiveServer

<PageTitle>Резюме</PageTitle>

@if(resume is null){
    <p><em>Loading...</em></p>
} else {
    <a class="btn btn-primary me-2 mt-3" role="button" href="/ResumeEdit">
        <i class="bi bi-file-earmark-plus"></i>
    </a>

    <table class="table table-striped table-bordered table-hover mt-3">
        <thead class="table-dark">
            <th>Ім'я</th>
            <th>Професія</th>
            <th>Вимоги</th>
            <th>Телефон</th>
            <th></th>
    </thead>
    <tbody>
        @foreach (var res in resume) {
            <tr>
                <td>@res.FirstName</td>
                <td>@res.Profession.Name</td>
                <td>@res.Requirements</td>
                <td>@res.Phone</td>
                <td>
                    <div class="d-flex">
                        <a class="btn btn-primary me-2" role="button" href="@GetResumeUrl(res.Id)">
                            <i class="bi bi-eye"></i>
                        </a>
                        <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="@GetDeleteModalId(res)">
                            <i class="bi bi-x-lg"></i>
                        </button>
                    </div>
                    <DeleteResumeDialog res="@res" />
                </td>
            </tr>
        }
    </tbody>
</table>
}


@code {
    List<Resume>? resume;

    protected override async Task OnInitializedAsync() {
        resume = await Client.GetResumeAsync() ?? [];
    }

    private static string GetResumeUrl(int id) => $"/ResumeDetails/{id}";

    private string GetDeleteModalId(Resume resume) {
        return $"#{DeleteResumeDialog.GetModalId(resume)}";
    }
}